function UploadController(e,t,n){n.info("Initializing UploadController..."),e.files=[],e.errors=[],e.num_files_waiting=0,e.uploadAll=function(){e.uploader.uploadStoredFiles()},e.dismissError=function(t){e.errors.splice(e.errors.indexOf(t),1)},e.apply=function(e){var t=this.$root.$$phase;"$apply"==t||"$digest"==t?e&&"function"==typeof e&&e():this.$apply(e)},e.uploader=new qq.FineUploaderBasic({debug:!0,autoUpload:!1,button:$("#btn-select-files")[0],element:document.getElementById("uploader"),request:{endpoint:null},callbacks:{onValidate:function(){n.info("onValidate")},onSubmit:function(o,i){n.info("onSubmit"),e.apply(function(){var n=e.uploader.getFile(o);t.get(e.endpoints.content_types,{params:{mimetype:n.type}}).success(function(t){var n=t.content_types,l={id:o,name:i,size:e.uploader.getSize(o),file:e.uploader.getFile(o)};return 0===n.length?(l.status="Error",l.error="There is no content type in this context that knows create items from that file type.",e.errors.splice(o,0,l),!1):(l.status="ready for upload",l.transfered={bytes:0,percent:0},l.allowed_types=n,l.desired_type=n[0],e.files.splice(o,0,l),void e.num_files_waiting++)})})},onUpload:function(t){n.info("onUpload"),e.apply(function(){e.files[t].status="uploading",e.uploader.setParams({content_type:e.files[t].desired_type.name},t),e.num_files_waiting--})},onProgress:function(t,n,o,i){e.apply(function(){e.files[t].transfered.bytes=o,e.files[t].transfered.percent=Math.round(o/i*100)})},onCancel:function(t){n.info("onCancel"),e.apply(function(){e.files[t].status="cancelled"})},onError:function(t){return n.info("onError"),e.apply(function(){e.files[t].status="failed"}),!1},onComplete:function(t,o,i){n.info("onComplete"),e.apply(function(){"uploading"==e.files[t].status&&(e.files[t].status="complete",e.files[t].url=i.url)})}}}),e.$watch("endpoints",function(t){e.uploader.setEndpoint(t.upload)}),n.info("UploadController initialized.")}var app=angular.module("kotti",[]);app.filter("bytes",function(){return function(e,t){if(isNaN(parseFloat(e))||!isFinite(e))return"-";"undefined"==typeof t&&(t=1);var n=["bytes","kB","MB","GB","TB","PB"],o=Math.floor(Math.log(e)/Math.log(1024));return isFinite(o)||(o=0),(e/Math.pow(1024,Math.floor(o))).toFixed(t)+" "+n[o]}});